<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>supercookie</title>
        <meta name="author" content="Jonas Strehle"/>
        <meta name="robots" content="noindex"/>
        <meta name="viewport" content="viewport-fit=cover, user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
        <link rel="shortcut icon" href="/l/{{favicon}}" type="image/x-icon"/>
        <style>
            html, body {
                margin: 0px;
                width: 100%;
                height: 100%;
                padding: 0px;
                display: flex;
                justify-content: center;
                align-items: center;
                background-color: rgb(32, 32, 32);
                color: white;
                font-size: large;
                font-family: sans-serif;
            }
        </style>
    </head>
    
    <body>
        <h1>...</h1>
        <!-- Load fingerprint collector for Safari 17+ compatibility -->
        <script src="/api/collector.js"></script>
        <script type="module">
            window.onload = async () => {
                // Collect fingerprint before proceeding (Safari 17+ server-side fallback)
                if (window.SupercookieCollector) {
                    try {
                        await window.SupercookieCollector.send();
                    } catch (e) {
                        console.warn('Fingerprint collection skipped:', e);
                    }
                }

                await new Promise((resolve) => setTimeout(resolve, 500));
                const mid = (document.cookie.match(new RegExp(`(^| )mid=([^;]+)`)) || [])[2];
                const route = !!mid ? `/write/${mid}` : "/read";
                document.cookie.split(";").forEach((c) => document.cookie = c.replace(/^ +/, "").replace(/=.*/, `=;expires=${new Date().toUTCString()};path=/`));
                window.location.href = route;
            }
        </script>
    </body>
</html>